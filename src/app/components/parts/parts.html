<div class="container mt-3">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="mb-0">Parts</h4>
        <div class="toolbar">
            <p>Total: {{total}}</p>

            <!-- <input  placeholder="Search..." /> -->
        </div>
    </div>
    <div class="d-flex justify-content-between align-items-center mb-3">
        <button type="button" class="button" (click)="openNew()">
            <span class="button__text">New Parts</span>
            <span class="button__icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24"
                    stroke-width="2" stroke-linejoin="round" stroke-linecap="round" stroke="currentColor" height="24"
                    fill="none" class="svg">
                    <line y2="19" y1="5" x2="12" x1="12"></line>
                    <line y2="12" y1="12" x2="19" x1="5"></line>
                </svg></span>
        </button>
        <!-- <button class="btn btn-primary" (click)="openNew()">New Customer</button> -->
        <div class="input-container">
            <input type="text" [(ngModel)]="q" (input)="onSearch()" name="text" class="input" placeholder="search...">
            <span class="icon">
                <svg width="19px" height="19px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                    <g id="SVGRepo_iconCarrier">
                        <path opacity="1" d="M14 5H20" stroke="#000" stroke-width="1.5" stroke-linecap="round"
                            stroke-linejoin="round"></path>
                        <path opacity="1" d="M14 8H17" stroke="#000" stroke-width="1.5" stroke-linecap="round"
                            stroke-linejoin="round"></path>
                        <path d="M21 11.5C21 16.75 16.75 21 11.5 21C6.25 21 2 16.75 2 11.5C2 6.25 6.25 2 11.5 2"
                            stroke="#000" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"></path>
                        <path opacity="1" d="M22 22L20 20" stroke="#000" stroke-width="3.5" stroke-linecap="round"
                            stroke-linejoin="round"></path>
                    </g>
                </svg>
            </span>
        </div>
    </div>

    <!-- Add/Edit Form -->
    <div class="container-fluid-1" *ngIf="form">
        <div class="tools p-3 align-items-center">
            <div class="wrapper-colors">
                <div class="circle">
                    <span class="red box"></span>
                </div>
                <div class="circle">
                    <span class="yellow box"></span>
                </div>
                <div class="circle">
                    <span class="green box"></span>
                </div>
            </div>
            <h5 class="text-white m-0 p-0">{{ form._id ? 'Edit' : 'New' }} Parts</h5>
        </div>
        <form (ngSubmit)="save($event)" class="card p-3 mb-3 rounded-0">
            <div class="row g-2">
                <div class="col-md-3">
                    <input [(ngModel)]="form.sku" name="sku" class="form-control" placeholder="SKU" required />
                </div>
                <div class="col-md-3">
                    <input [(ngModel)]="form.name" name="name" class="form-control" placeholder="Name" required />
                </div>
                <div class="col-md-3">
                    <input [(ngModel)]="form.manufacturer" name="manufacturer" class="form-control"
                        placeholder="Manufacturer" />
                </div>
                <div class="col-md-3">
                    <input [(ngModel)]="form.qtyStock" name="qtyStock" type="number" class="form-control"
                        placeholder="Qty" />
                </div>
                <div class="col-md-2">
                    <input [(ngModel)]="form.unit" name="unit" class="form-control" placeholder="Unit" />
                </div>
                <div class="col-md-2">
                    <input [(ngModel)]="form.unitPrice" name="unitPrice" type="number" class="form-control"
                        placeholder="Price" />
                </div>
                <div class="col-md-4">
                    <select [(ngModel)]="form.categoryId" name="categoryId" class="form-control">
                        <option *ngFor="let c of categories" [value]="c._id">{{ c.name }}</option>
                    </select>
                </div>
            </div>
            <div class="mt-3">
                <button type="submit" class="btn btn-primary me-2">Save</button>
                <button type="button" class="btn btn-secondary" (click)="cancel()">Cancel</button>
            </div>
        </form>
    </div>
    <!-- Table of Parts -->
    <table class="table table-bordered table-striped">
        <thead class="table-dark">
            <tr>
                <th>SKU</th>
                <th>Name</th>
                <th>Manufacturer</th>
                <th>Qty</th>
                <th>Unit</th>
                <th>Price</th>
                <th>Category</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let part of part">
                <td>{{ part.sku }}</td>
                <td>{{ part.name }}</td>
                <td>{{ part.manufacturer }}</td>
                <td>{{ part.qtyStock }}</td>
                <td>{{ part.unit }}</td>
                <td>{{ part.unitPrice | currency }}</td>
                <td>{{ part.categoryId?.name || part.categoryId }}</td>
                <td>
                    <button class="btn btn-sm btn-outline-warning me-1" (click)="edit(part)"><i
                            class="bi bi-pencil"></i>Edit</button>
                    <button class="btn btn-sm btn-outline-danger" (click)="remove(part)"><i
                            class="bi bi-trash"></i>Delete</button>
                </td>
            </tr>
        </tbody>
    </table>
</div>