<div class="d-flex justify-content-between mb-2">
    <h3>Vehicles</h3>
    <input [(ngModel)]="q" (input)="onSearch()" placeholder="Search vehicles..." />
    <button class="btn btn-primary" (click)="openNew()">New Vehicle</button>
</div>
<div class="d-flex justify-content-between mb-2">
    <h3></h3>
    <p>Total: {{total}}</p>
</div>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>licensePlate</th>
            <th>VIN</th>
            <th>Owner</th>
            <th>Make</th>
            <th>Model</th>
            <th>Year</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let v of vehicles">
            <td>{{v.licensePlate}}</td>
            <td>{{v.vin}}</td>
            <td>{{customersMap[v.customerId]}}</td>
            <td>{{v.make}}</td>
            <td>{{v.model}}</td>
            <td>{{v.year}}</td>
            <td>
                <button class="btn btn-sm btn-primary me-1" (click)="edit(v)">Edit</button>
                <button class="btn btn-sm btn-danger" (click)="remove(v)">Delete</button>
            </td>
        </tr>
    </tbody>
</table>

<div *ngIf="form" class="card p-3 mt-3">
    <h5>{{form.id ? 'Edit' : 'New'}} Vehicle</h5>
    <form (submit)="save($event)">
        <select class="form-select mb-2 text-dark" [(ngModel)]="form.customerId" name="customerId">
            <option *ngFor="let c of customers" [value]="c._id">{{c.firstName}}{{c.lastName}}</option>
        </select>
        <input class="form-control mb-2" placeholder="Plate" [(ngModel)]="form.licensePlate" name="plate" />
        <input class="form-control mb-2" placeholder="VIN" [(ngModel)]="form.vin" name="vin" />
        <input class="form-control mb-2" placeholder="Make" [(ngModel)]="form.make" name="make" />
        <input class="form-control mb-2" placeholder="Model" [(ngModel)]="form.model" name="model" />
        <input class="form-control mb-2" placeholder="Year" type="number" [(ngModel)]="form.year" name="year" />
        <div class="d-flex justify-content-end gap-2">
            <button class="btn btn-secondary" type="button" (click)="cancel()">Cancel</button>
            <button class="btn btn-success" type="submit">Save</button>
        </div>
    </form>
</div>